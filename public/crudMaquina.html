<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>maquina</title>
    <!-- Link fonte -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap"
      rel="stylesheet"
    />
    <!-- Link CSS -->

    <link rel="stylesheet" href="css/cadastroMaquina.css" />
    <!-- Link icones -->
    <link
      rel="stylesheet"
      href="https://unicons.iconscout.com/release/v4.0.0/css/line.css"
    />
    <link
      rel="shortcut icon"
      href="assets/logo/logo-footer.png"
      type="image/x-icon"
    />
  </head>

  <body onload="AllMachines()">
    <div class="mainlogin">
      <div class="son_card">
        <div class="header">
          <div class="header-title">
            <img
              class="uil-user-circle"
              src="assets/imgs/icon-maquina.png"
              alt=""
            />
            <h1>MÁQUINAS</h1>
          </div>

            <div>
              <button onclick="TesteListar()">refresh</button>
              <button class="btn-add-machine" onclick="AddMachine()">+ add</button>
            </div>
        </div>

        <!--    <div class="block_text">
          <div class="textfield">
            <label for="maquina">ID da máquina:</label>
            <input id="id_maquina" type="text" placeholder="Insira o id" />
            <i class="uil uil-cog"></i>
          </div>

          <div class="textfield">
            <label for="usuario">Setor:</label>
            <input
              id="setor_maquina"
              type="password"
              placeholder="Insira o setor:"
            />
            <i class="uil uil-store-alt"></i>
          </div>

          <button class="btnlogin" onclick="cadastrarMaquina()">Proximo</button>
        </div>
      </div> -->

      <div id="modal" class="modal-add-machine"></div>

      <div class="div-list-machines">
        <table id="tabelaMaquina" class="table-machines">
          <tr>
            <td class="td-title">ID:</td>
            <td class="td-title">Código de Patrimonio:</td>
            <td class="td-title">Usuário da Máquina:</td>
            <td class="td-title">Empresa:</td>
          </tr>
        </table>
      </div>
    </div>

    <!-- <div class="footer">
      <div class="img_footer">
          <img src="img/Group 97.png">
      </div>

      <div class="social">
          <h1>Social</h1>
          <li><a href="#">Facebook</a></li>
          <li><a href="#">Instagram</a></li>
          <li><a href="#">Linkedin</a></li>
      </div>


      <div class="ajuda">
          <h1>Ajuda</h1>
          <li><a href="#">Suporte</a></li>
          <li><a href="#">Contato</a></li>

      </div>

      <div class="voltar">
         <a href="#navbar"> <img src="img/carbon_back-to-top.png"></a>

      </div>

  </div> -->
  </body>
</html>

<script>

  function TesteListar(){

    var json = [
      {
        id_maquina: 1,
        codigo_patrimonio: "123456",
        nome_usuario_maquina: "Paul",  
        nome_empresa: "Beatles",
      },
      {
        id_maquina: 2,
        codigo_patrimonio: "123456",
        nome_usuario_maquina: "Paul",
        nome_empresa: "Beatles",
      },
      {
        id_maquina: 3,
        codigo_patrimonio: "123456",
        nome_usuario_maquina: "Ring",
        nome_empresa: "Beatles",
      },
      {
        id_maquina: 4,
        codigo_patrimonio: "123456",
        nome_usuario_maquina: "George",
        nome_empresa: "Beatles",        
      },
    ];

    console.log(json[0]);

    for (i = 0; i < json.length; i++) {
            div = `<tr id="users-data" class="machines-data"> 
                    <td class="td-content"> ${json[i].id_maquina} </td> 
                    <td class="td-content"> ${json[i].codigo_patrimonio} </td> 
                    <td class="td-content"> ${json[i].nome_usuario_maquina} </td> 
                    <td class="td-content"> ${json[i].nome_empresa} </td> 
                    <td class="td-content"> 
                      <span style="cursor:pointer;"> 
                        <img src="assets/svg/edit.svg"> 
                      </span> 
                    </td>
                    <td class="td-content">  
                      <span style="cursor:pointer;"> 
                        <img src="assets/svg/delete.svg">
                      </span> 
                    </td>
                  </tr>`;

            tabelaMaquina.innerHTML += div;
  }
}

function AddMachine() {
    document.getElementById("modal").style.display = "flex";

    document.getElementById("modal").innerHTML = `
    <div class="modal-header">
      <h2>Add User</h2>
      <button onclick="CloseModal()" class="btn-close-modal"> 
        <img src="assets/svg/cancel.svg">
      </button>
    </div>
    <div class="block_text">
      <div class="textfield">
        <label for="maquina">ID da máquina:</label>
        <input id="id_maquina" type="text" placeholder="Insira o id" />
        <i class="uil uil-cog"></i>
      </div>

      <div class="textfield">
        <label for="usuario">Setor:</label>
          <input
            id="setor_maquina"
            type="password"
            placeholder="Insira o setor:"
          />
          <i class="uil uil-store-alt"></i>
      </div>
      <button class="btnlogin" onclick="cadastrarMaquina()">Proximo</button>
    </div>
    `;
}

function CloseModal() {
    document.getElementById("modal").style.display = "none";
}

  // function listUser(){

  //   fetch("/usuarios/listar",{
  //     method: "GET",
  //     headers: {
  //         "Content-Type": "application/json",
  //       },

  //   }).then(function (resposta) {

  //      resposta.json()
  //      .then((json) => {

  //       console.log("ACERTO JSON ", json)
  //       console.log("ACERTO JSON STRING ",JSON.stringify(json))

  //       for(i = 0; i < json.length; i++){

  //         user_maquina.innerHTML += `<option value="${json[i].nome_usuario_maquina}"> ${json[i].nome_usuario_maquina} </option>`

  //            }

  //      })

  //   }).catch(function (erro) {

  //      console.log("O erro -> " + erro);

  //   })

  // }

  function AllMachines() {
    fetch("usuarios/listarMaquinas", {
      method: "GET",
      headersa: {
        "Content-Type": "application/json",
      },
    })
      .then(function (resposta) {
        console.log("Front ok");

        resposta.json().then((json) => {
          console.log(json);

          for (i = 0; i < json.length; i++) {
            div = `<tr> 
                    <td> ${json[i].id_maquina} </td> 
                    <td> ${json[i].codigo_patrimonio} </td> 
                    <td> ${json[i].nome_usuario_maquina} </td> 
                    <td> ${json[i].nome_empresa} </td> 
                    <td> 
                      <span style="cursor:pointer;"> Editar </span> 
                    </td>
                    <td>  
                      <span style="cursor:pointer;"> Excluir </span> 
                    </td>
                  </tr>`;

            tabelaMaquina.innerHTML += div;
          }
        }); 
      })
      .catch(function (resposta) {
        console.log("Front zuo");

        console.log(resposta);
      });
  }
</script>